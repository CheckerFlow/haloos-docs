# 理想星环OS开源项目介绍

## 1. 简介
**理想星环OS（LiAuto HaloOS）** 是理想汽车针对现代智能汽车日益增长的系统复杂性、功能多样性及高性能需求，自主研发的一款整车级操作系统。其核心目标是为整车范围内的计算、通信与控制功能提供一个统一、高效、可靠的技术基础平台。通过采用开源模式并结合自身研发实践，理想星环OS旨在突破传统封闭式车载系统在灵活性、扩展性及协同效率方面的瓶颈，为车辆智能化功能的持续开发与演进提供支撑

在技术架构层面，理想星环OS基于“全域协同计算模型”进行设计，以实现系统级的深度优化。关键的跨域调度能力显著提升了车辆核心“感知-决策-执行”链路的处理效率与运行稳定性，实测数据显示响应效率提升1倍、稳定性提高5倍。这一优化在具体应用场景中带来了可量化的性能改善：例如，在120km/h的高速工况下，系统能够将AEB（自动紧急制动）的刹停距离有效缩短7米；同时，通过精密的跨域协同控制，悬架系统的响应速率及车身姿态控制精度提升了73%。安全方面，系统采用了软硬件一体化的纵深防护架构，集成了高性能密码学算法实现（特定算法性能达到主流方案的4-8倍）以及端到端的安全通信与访问控制机制，旨在构建一个可信的车载计算环境，有效应对智能化和网联化带来的复杂安全挑战

在工程效率与硬件适配性方面，理想星环OS通过自研的虚拟化框架和异构计算资源共享技术，着力解决资源利用率和开发效率问题。实测表明，该技术有效降低了AI算力相关的虚拟化开销达80%，并将虚拟化环境下的设备访问延迟缩减了90%。同时，系统设计注重硬件平台的可移植性，支持对包括芯驰、英飞凌、英伟达、地平线在内的多种主流及新兴车规级芯片进行快速适配，将新芯片平台的适配与验证周期从行业通常的3-6个月显著压缩至4周。这种技术体系直接有助于降低整车软件的开发成本、减少对特定硬件的强依赖，从而支持汽车制造商更高效地进行智能化功能的迭代开发与部署

理想星环OS选择开源的核心出发点是促进汽车产业内的技术协作，共同应对基础软件层面普遍存在的重复投入问题（“重复造轮子”）。通过开放核心技术，期望能够与行业伙伴（包括其他车企、芯片供应商、软件开发者等）共同建设和完善车载操作系统技术，实现技术成果的共享与协同发展，最终将更先进、可靠的技术更快地应用到量产车辆中，惠及广大用户

## 2. 技术架构

理想星环OS是一款面向AI及智能化业务需求的整车操作系统，其核心设计在于实现全域协同与软硬结合，注重在性能、安全、成本及效率等维度提供有竞争力的解决方案，并为未来更复杂的系统功能演进提供支持。其架构设计聚焦于以下几个方面：
- 资源集中与共享：算力池化、通信以太网化、全域调度、服务共享
- 极致性能：混合系统中关键链路的端到端实时性、确定性、可靠性
- 快速迭代：软硬解耦、软软解耦、服务化设计、定制化工具
- 高安全性：原生安全的体系化纵深安全防护，保护隐私数据和控车指令

![HaloOS总架构](./_static/image/readme/arch.png)

理想星环OS由以下四个主要部分组成，这些部分如同人体的不同系统，可以比作人的大脑、小脑、神经系统和免疫系统，协同工作以支撑整车功能：

### 2.1. 智能驾驶系统

此部分可类比为车辆的”大脑“控制系统，负责处理复杂的计算密集型任务，保证智能驾驶又快又好的工作。设计重点在于提升计算效率和资源利用率：

- 通过任务调度、图像处理等优化措施，提高AI相关算法的运行速度和稳定性
- 利用虚拟化技术实现算力共享，允许单一芯片安全地并发处理多个任务，提高硬件资源利用率

### 2.2. 智能车控系统

此部分定位类似于车辆的“小脑”控制系统，专注于车辆底层控制指令的快速、精确执行（如车灯、空调、电机控制等）。设计重点在于灵活性和效率：

- 通过灵活的硬件适配层，支持不同品牌、不同架构的MCU芯片，为硬件选型提供更多自由度，并缩短新MCU的集成时间
- 在关键性能指标（如响应时间）与资源占用（如内存占用）方面进行了优化，使得在满足性能要求的前提下，探索将多个功能整合到单一硬件单元的可能性，支持成本优化策略
- 配套提供自动化配置工具、PC端硬件模拟器以及覆盖资源、性能、诊断的分析工具集，旨在提升研发效率

### 2.3. 通信中间件

此部分承担着车辆“神经系统”的角色，作为车辆内部的“信息通路”，负责在不同计算单元（域控制器、SoC、MCU）之间以及域内部组件之间，实现高效、可靠的数据通信。设计重点在于通信的效率和可靠性：

- 效率：统一了车内多种设备的应用层通信协议接口，实现通信标准化，降低了各域之间的耦合度，提升了集成和开发效率
- 可靠性：在关键特性、核心指标和资源优化方面力求达到行业先进水平，并结合双通道备份等技术手段，提升通信链路的可靠性

### 2.4. 信息安全系统

此部分相当于智能汽车的“免疫系统”，旨在保护用户隐私数据和控车指令的安全性。通过软硬件协同设计，构建系统化的安全体系，达成四个核心安全目标：系统完整性保护、数据加密与保护、身份认证与权限管控、以及构建可信执行环境，从而实现多层次的纵深防御体系

### 2.5. 技术架构小结

理想星环OS的四大支柱并非相互独立的模块，而是构成一个深度融合、协同运作的有机整体 —— 恰如人体的不同系统协调一致，共同支撑高级智能行为。以通信中间件作为信息交互的主干，理想星环OS确保了智能驾驶系统产生的决策能够高效、可靠地传递给智能车控系统执行，同时也保证了传感器与处理单元之间的数据流畅通

基于这种一体化架构，理想星环OS能够提供系统级的保障能力，例如：

- 确定性方面：通过全局任务调度、优先级管理以及确定性通信机制的协同，理想星环OS致力于保障从传感器感知、决策生成到最终控制执行的端到端任务链路具有可预测且稳定的低时延。即使在多任务并发的复杂工况下，也能维持运行的稳定性与可靠性，这对于需要精确时序控制的功能（如智能驾驶）至关重要
- 安全性方面：信息安全防护贯穿于整个操作系统。统一的安全架构将身份认证、权限管控、完整性保护和数据加密等措施系统性地应用于所有组件、接口和通信链路中。结合可信执行环境（TEE）和硬件安全模块（HSM）的底层支持，实现了从硬件可信根到上层应用、从系统启动到运行时的全方位、多层次纵深防御，旨在有效抵御跨模块、跨系统的潜在攻击渗透

正是这种高度协同的有机整体性，使得理想星环OS不仅仅是功能的简单集合，更是一个能够进行全局优化、统一管理、并提供系统性安全保障的平台，为智能汽车提供兼具高性能、高安全、高效率的核心支撑，并为承载未来更复杂的系统功能奠定基础

> 提示：更多技术架构相关内容，请移步 [理想星环OS官网](https://www.lixiang.com/tech/haloos) 获取并阅读《理想星环OS技术架构白皮书》

## 3. 关键技术

在智能网联汽车软件平台的开发进程中，普遍面临四个核心矛盾与工程挑战：
- 有限算力资源与严苛成本约束之间的资源优化难题
- 快速迭代的软件生态与长周期硬件开发之间的协同适配挑战
- 持续增长的系统复杂度与亚毫秒级实时确定性要求之间的技术平衡问题
- 智能化网联化演进与信息安全/功能安全双重风险防范之间的体系化矛盾

在此背景下，理想星环OS构建以下关键技术方案（如下图所示），旨在通过系统性设计与技术融合，应对这些挑战，实现矛盾破解：

![主要矛盾与关键技术方案](./_static/image/readme/arch3.png)

### 3.1. 矛盾1：算力 vs 成本

描述：增长的AI算力需求和可控成本间的矛盾

解决思路：操作系统为核心，构筑整车级资源共享与协同能力

- 算力池化（虚拟化）：虚拟化技术将异构计算资源（CPU、NPU、IO设备等）抽象为统一的“算力池”。通过全局资源视图和智能调度算法，动态分配和回收算力资源，实现跨域、跨应用共享
- 车载通信以太网化（带宽资源共享）：深度集成并优化车载以太网协议栈，实现不同域控制器或计算单元之间的低延迟、高带宽数据交换和服务调用
- 应用平滑迁移（统一的应用API）：提供标准化API接口（如POSIX），降低应用软件对特定硬件的依赖，方便应用在不同计算节点之间部署、迁移

### 3.2. 矛盾2：软件 vs 硬件迭代周期

描述：软件快速迭代和硬件研发周期的矛盾

解决思路：深度解耦、灵活适配的软件架构

- 软硬解耦（灵活的BSP适配接口）：支持并兼容多类型的软硬件接口（MCAL、HAL），方便芯片快速适配
- 软软解耦（应用隔离）：在MCU上实现不同业务软件的隔离。使车控应用模块化、服务化，可实现独立迭代与升级
- 定制化工具：不断完善的工具链与仿真环境，简化开发依赖，提升效率

### 3.3. 矛盾3：复杂系统 vs 实时性/稳定性

描述：系统复杂性与实时确定性需求的矛盾

解决思路：跨域协同，构建端到端实时确定性解决方案

- 硬实时内核：采用抢占式、优先级驱动的硬实时调度策略。实现极低的、可预测的中断延迟和任务切换开销
- 端到端确定性调度：全局视角管理跨多核异构处理器甚至不同物理节点的关键任务链，通过全局同步、协同调度技术，统一编排计算任务与数据流，确保时序约束
- 确定性通信：深度优化车载以太网通信栈，降低进程间/虚拟机间/芯片间通信延迟，为关键数据流提供可保证的带宽、有界延迟和极低抖动
- 一体化工具：提供自研工具进行端到端时序分析与验证，可自动生成最优的调度和通信配置

### 3.4. 矛盾4：智能网联化 vs 安全风险

描述：智能化网联化与安全风险收敛的矛盾

解决思路：通过软硬协同，构建原生、体系化的纵深安全防御

- 数据加密与保护：运用强加密算法和安全的密钥管理机制，确保敏感数据在存储和传输时的机密性与完整性
- 系统完整性保护：启动时构建基于信任链的逐级验证机制。运行时持续监控关键系统文件，防止恶意修改
- 身份认证与权限管控：对访问系统资源的实体进行细粒度的身份认证和权限管控，确保只有合法主体能够访问和操作资源
- 可信执行环境：利用硬件隔离技术（如ARM TrustZone）创建隔离的TEE OS，用于执行最敏感的操作，保护核心资产安全

## 4. 开源计划

理想星环OS会从2025年4月底逐步开放源码：

![开源计划](./_static/image/readme/arch2.png)

## 5. 快速开始

|步骤|指导文档|
|-|-|
|第一步：下载|[源码下载流程](quick_start/01_downloading.md)|
|第二步：编译|[工程编译流程](quick_start/02_compiling.md)|
|第三步：运行|[部署运行流程](quick_start/03_running.md)|

## 6. 代码目录结构

```
haloosspace
├── .repo                  # Repo manifest仓库，配置多仓库同步规则（基于Repo工具）
├── apps                   # 示例应用集合
│   ├── rt_demo            # 关键周期任务实时性示例工程
│   ├── vbslite_demo       # 车载通信总线轻量化示例工程
│   └── (...)              # （暂未开源）其他高级应用Demo
├── build                  # 构建系统配置(编译脚本、CMake/Makefile规则)
├── docs                   # HaloOS项目综合文档
│   ├── ...                # 快速开始、贡献方式等
│   └── README.md          # HaloOS项目总体介绍
├── tools                  # 开发工具链
│   ├── halo_trace         # 系统级性能追踪工具（记录任务/中断时序）
│   └── (...)              # （暂未开源）其他HaloOS配套工具
├── vbs                    # 通信中间件
│   ├── docs               # 通信中间件开发者文档
│   ├── (vbspro)           # （暂未开源）vbspro功能实现
│   └── vbslite            # vbslite功能实现
├── vcos                   # 智能车控系统
│   ├── apps               # 系统内置应用
│   ├── build              # 系统构建配置、编译脚本等
│   ├── components         # 核心功能组件（如通信栈、存储栈实现）
│   ├── docs               # 智能车控系统开发者手册
│   ├── drivers            # 硬件驱动（如I/O、CAN、以太网）
│   ├── examples           # 系统关键示例
│   ├── external           # 第三方开源软件
│   ├── include            # 全局头文件（POSIX/功能栈接口定义，当前为空）
│   ├── kernel             # 内核源码
│   ├── tests              # 测试框架与测试用例
│   ├── vcos_studio        # VCOS配套配置、维测等工具功能实现
│   └── vendor             # 第三方适配代码
└── (...)                  # （暂未开源）其他子系统（如智能驾驶OS、虚拟化引擎等）
```

## 7. 子系统文档

|子系统类型|子系统介绍|开发者文档合集|
|-|-|-|
|智能车控系统|[《智能车控OS子系统介绍》](https://gitee.com/haloos/vcos/blob/master/OVERVIEW.md)|[智能车控OS子系统开发者文档合集索引](https://gitee.com/haloos/vcos/blob/master/README.md)|
|通信中间件|[《通信总线子系统介绍》](https://gitee.com/haloos/vbs/blob/master/OVERVIEW.md)|[通信总线子系统开发者文档合集索引](https://gitee.com/haloos/vbs/blob/master/README.md)|
|（待开源）|...|...|

> 后续开源内容的开发者文档将会随代码一同上线

## 8. 关键技术实践

|子系统|子系统关键实践|
|-|-|
|智能车控OS|[《关键周期任务确定性方案实践》](tech_cases/key_periodic_task_real_time_practice.md)|
|通信总线|[《车载通信总线轻量化创新实践》](tech_cases/vehicle_communication_bus_lightweight_practice.md)|
|（待开源）|...|...|

> 后续开源内容的关键技术实践文档将会随代码一同上线

## 9. 支持的开发平台

HaloOS现已适配多种开发平台，基于当前开源功能内容，下表介绍几款已验证的典型开发板/环境：

|可运行子系统|开发板/环境|芯片型号|主要功能|典型应用场景|参考购买链接|
|-|-|-|-|-|-|
|智能车控OS、通信总线|芯驰 E3650 Dev Kit 开发板套件|E3650|集成4个32位ARM Cortex R52 + CPU锁步核，支持多核并行处理；板上配备UART转串口芯片，用于和上位机进行交互；支持ADC接口、SENT接口、CAN-FD接口、LIN接口以及两个千兆以太网口；板上配备按键，支持低功耗模式快速验证；预留Flash、eMMC焊盘支持外扩存储介质|区域控制应用、电驱控制应用、底盘控制应用、智能驾驶控制应用等|[官方链接](https://www.semidrive.com/product/E3650)|
|智能车控OS、通信总线|英飞凌 KIT_A2G_TC397XA_3V3_TFT 开发板|TC397|集成6个32位高性能CPU核（TC1.6.2P），支持多核并行处理；配备4个LED和蜂鸣器用于显示交互；支持CAN-FD接口、LIN接口、千兆以太网和USB/UART桥接通信；内置SD卡槽扩展存储功能|区域控制应用、电驱控制应用、底盘控制应用、智能驾驶控制应用等|[官方链接](https://www.infineon.com/cms/en/product/evaluation-boards/kit_a2g_tc397xa_3v3_tft/)|
|智能车控OS、通信总线|智能车控OS SIM 模拟器|-|提供基于Linux/WSL的虚拟化运行环境，无需硬件支持；支持中断信号模拟、以太通信（含VLAN）及虚拟网桥配置；集成虚拟以太驱动（vEth）实现TCP/IP协议栈；支持GDB调试工具|软件测试、开发调试、算法验证|无需购买，本项目自带（使用方式可参考[部署运行流程](quick_start/03_running.md)）|

## 10. 许可协议

理想星环OS主要遵循 [Apache License V2.0](https://www.apache.org/licenses/LICENSE-2.0.txt) 协议，详情请参考各代码仓LICENSE声明

HaloOS引用三方开源软件及许可证说明，参考[第三方开源软件说明](notices/third_party_open_source_software_notice.md)

## 11. 联系方式

邮箱：[HaloOS@lixiang.com](mailto:HaloOS@lixiang.com)

网站：https://www.lixiang.com/tech/haloos

## 12. 参与贡献

[贡献方式](CONTRIBUTING.md)

## 13. 免责申明

[免责声明](DISCLAIMER.md)
